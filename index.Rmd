---
title: "Music inspired by classical songs"
author: "Juliette de Waal"
date: "9 februari 2021"
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
---
```{r, echo=FALSE}
library(tidyverse)
library(spotifyr)
library(usethis)
library(remotes)
library(ggthemes)
library(plotly)
```
### eerste info

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, echo=FALSE}
classical <- get_playlist_audio_features("", "0UEGOBtALCL7RgScgDhUx1")
new <- get_playlist_audio_features("", "3jqW2ItEMYCM3Pl5Fnj3Pu")

new

classical %>%
  summarise(
    mean_speechiness = mean(speechiness),
    mean_acousticness = mean(acousticness),
    mean_liveness = mean(liveness),
    sd_speechiness = sd(speechiness),
    sd_acousticness = sd(acousticness),
    sd_liveness = sd(liveness),
    median_speechiness = median(speechiness),
    median_acousticness = median(acousticness),
    median_liveness = median(liveness),
    mad_speechiness = mad(speechiness),
    mad_acousticness = mad(acousticness),
    mad_liveness = mad(liveness)
  )

new %>%
  summarise(
    mean_speechiness = mean(speechiness),
    mean_acousticness = mean(acousticness),
    mean_liveness = mean(liveness),
    sd_speechiness = sd(speechiness),
    sd_acousticness = sd(acousticness),
    sd_liveness = sd(liveness),
    median_speechiness = median(speechiness),
    median_acousticness = median(acousticness),
    median_liveness = median(liveness),
    mad_speechiness = mad(speechiness),
    mad_acousticness = mad(acousticness),
    mad_liveness = mad(liveness)
  )
```
Portfolio for the course Computational Musicology - Juliette de Waal (12348759) <br/>

Some time ago I heard a song named 'a Fifth of Beethoven' by Walter Murphy, and I really liked it. It is a disco instrumental song based on Beethoven's Symphony No. 5. I thought using famous classical music pieces to create new songs of another genre is a really cool concept. So I did some research and discovered that there are many more famous songs that are based and inspired on a classical piece of music, also songs I know for a long time but never knew that they have a classical origin.<br/>
My corpus includes classical pieces and their linked new songs. I have found 25 pairs, so 50 songs in total.<br/>
I think that this corpus makes really interesting comparisments possible, on different levels.<br/>
For example between the songs based on the classical songs. What are the differences and similarities between these songs? Is the classical input used in the same way? Is there an common genre?<br/>
But of course exploring relation between the song based on a classic song and the original classical song itself is really interesting. To what extent do you see the original classical back in the new songs? In which way is the original song adapted in de new song? Which changes are made? Maybe the tempo changed or other instruments are used.<br/>
There are pairs of tracks in the corpus, like 'I can' – Nas/'Für Elise' -Beethoven and 'A fifth of Beethoven'-Woody/ Beethoven's Fifth Symphony- Beethoven, in which the relation with the origin classical song is very obvious. But there are also pairs in the corpus in which the original songs are more subtly included, like 'Grace Kelly'- Mika /  'Largo Al Factotum'- Rossini. <br/>
It's important that I define my research a bit more, but I think this is a really interesting and fun corpus to explore with enough possibilities.

***

### twee histogrammen

```{r, echo=FALSE}
project <-
  bind_rows(
    classical %>% mutate(category = "Classical"),
    new %>% mutate(category = "New")
  )
```

```{r, echo=FALSE}
plot_loudness <- project %>%
  ggplot(aes(x = loudness, fill = category)) +
  geom_histogram(binwidth = 0.5, position = "dodge")

ggplotly(plot_loudness)

plot_danceability <- project %>%
  ggplot(aes(x = danceability, fill = category)) +
  geom_histogram(binwidth = 0.1, position = "dodge")

ggplotly(plot_danceability)

```
I made some simple but clear histograms of the loudness and danceability of the classical en new songs, In the histograms you see the clear diference in the distributions of the two categories, classical songs and the new songs that are basted on the classical songs. The new songs are signifant louder than the classical songs. The danceability is also higher for the new songs.

***

### eind plot


```{r, echo=FALSE}
plot_all <- project %>%                    # Start with awards.
  mutate(
    mode = ifelse(mode == 0, "Minor", "Major")
  ) %>%
  ggplot(                     # Set up the plot.
    aes(
      x = valence,
      y = energy,
      size = loudness,
      colour = mode
    )
  ) +
  geom_point() +              # Scatter plot.
  geom_rug(size = 0.1) +      # Add 'fringes' to show data distribution.
  geom_text(                  # Add text labels from above.
    aes(
      x = valence,
      y = energy,
      label = label
    ),
    data = 
      tibble(
        label = c("Clair de Lune, L.32 ", "Say You'll Go"),
        category = c("Classical", "New"),
        valence = c(0.090, 0.123),
        energy = c(0.101, 0.967)
      ),
    colour = "red",         # Override colour (not mode here).
    size = 3,                 # Override size (not loudness here).
    hjust = "left",           # Align left side of label with the point.
    vjust = "bottom",         # Align bottom of label with the point.
    nudge_x = -0.05,          # Nudge the label slightly left.
    nudge_y = 0.02            # Nudge the label slightly up.
  ) +
  facet_wrap(~category) +     # Separate charts per playlist.
  scale_x_continuous(         # Fine-tune the x axis.
    limits = c(0, 1),
    breaks = c(0, 0.50, 1),   # Use grid-lines for quadrants only.
    minor_breaks = NULL       # Remove 'minor' grid-lines.
  ) +
  scale_y_continuous(         # Fine-tune the y axis in the same way.
    limits = c(0, 1),
    breaks = c(0, 0.50, 1),
    minor_breaks = NULL
  ) +
  scale_colour_brewer(        # Use the Color Brewer to choose a palette.
    type = "qual",            # Qualitative set.
    palette = "Paired"        # Name of the palette is 'Paired'.
  ) +
  scale_size_continuous(      # Fine-tune the sizes of each point.
    trans = "exp",            # Use an exp transformation to emphasise loud.
    guide = "none"            # Remove the legend for size.
  ) +
  theme_economist() +             # Use a simpler theme.
  labs(                       # Make the titles nice.
    x = "valence",
    y = "energy",
    colour = "Mode"
  )

ggplotly(plot_all)

```

This plot shows 4 variables. The x-axis variance, the y-axis energy, the size of the dots is loudness and the color is the mode.It points out some difference between the classical songs and the newer songs. Especially the difference in Valence and the difference energy are remarkable. 


```{r}
library(tidyverse)
library(spotifyr)
library(compmus)
```


